%let pgm=utl-lowest-order-polynomial-that-goes-through-a-set-of-points-lagrange-interpolation;

Lowest order polynomial that goes through a set of points lagrange interpolation;

github
https://tinyurl.com/vzsshu7n
https://github.com/rogerjdeangelis/utl-lowest-order-polynomial-that-goes-through-a-set-of-points-lagrange-interpolation

Lagrange interpolation

Side note                                      x
Infinite 'polynomial' power series for f(x)= e
 e^x = 1 + x + x^2 / 2! + x^3 / 3! + ..

/*                   _
(_)_ __  _ __  _   _| |_
| | `_ \| `_ \| | | | __|
| | | | | |_) | |_| | |_
|_|_| |_| .__/ \__,_|\__|
        |_|
*/

options validvarname=upcase;
libname sd1 "d:/sd1";
data sd1.have;
do x= 0 to 2 by .5;
   y=exp(x);
   ano = cats('(',put(x,2.1),',',put( y,5.1),')');
   output;
end;
run;quit;


/**************************************************************************************************************************/
/*                                                                                                                        */
/*   SD1.HAVE total obs=6                                                                                                 */
/*                                                                                                                        */
/* Obs     X        Y         ANO                                                                                         */
/*                                                                                                                        */
/*  1     0.0    1.00000    (.0,1.0)                                                                                      */
/*  2     0.5    1.64872    (.5,1.6)                                                                                      */
/*  3     1.0    2.71828    (1,2.7)                                                                                       */
/*  4     1.5    4.48169    (2,4.5)                                                                                       */
/*  5     2.0    7.38906    (2,7.4)                                                                                       */
/*                                                                                                                        */
/*         0.0          0.5          1.0          1.5          2.0                                                        */
/*       +--+------------+------------+------------+------------+--+                                                      */
/*       |    Fit these points exactly                             |                                                      */
/*       |                                                         |                                                      */
/*     8 +      X        Y                                         + 8                                                    */
/*       |                                                         |                                                      */
/*       |     0.0    1.00000                           (2,7.4) *  |                                                      */
/*       |     0.5    1.64872                                      |                                                      */
/*       |     1.0    2.71828                                      |                                                      */
/*       |     1.5    4.48169                                      |                                                      */
/*     6 +     2.0    7.38906                                      + 6                                                    */
/*       |                                                         |                                                      */
/*       |                                                         |                                                      */
/*  Y    |     Points are f(x)=exp(x)                              |                                                      */
/*       |                                                         |                                                      */
/*       |                                         * (2,4.5)       |                                                      */
/*     4 +                                                         + 4                                                    */
/*       |                                                         |                                                      */
/*       |                                                         |                                                      */
/*       |                                                         |                                                      */
/*       |                            * (1,2.7)                    |                                                      */
/*       |                                                         |                                                      */
/*     2 +                                                         + 2                                                    */
/*       |               * (.5,1.6)                                |                                                      */
/*       |                                                         |                                                      */
/*       |  * (.0,1.0)                                             |                                                      */
/*       |                                                         |                                                      */
/*       |                                                         |                                                      */
/*     0 +                                                         + 0                                                    */
/*       |                                                         |                                                      */
/*       +--+------------+------------+------------+------------+--+                                                      */
/*         0.0          0.5          1.0          1.5          2.0                                                        */
/*                                                                                                                        */
/*                                     X                                                                                  */
/*                                                                                                                        */
/**************************************************************************************************************************/

/*
 _ __  _ __ ___   ___ ___  ___ ___
| `_ \| `__/ _ \ / __/ _ \/ __/ __|
| |_) | | | (_) | (_|  __/\__ \__ \
| .__/|_|  \___/ \___\___||___/___/
|_|
*/
%utl_submit_wps64x('
libname sd1 "d:/sd1";
proc r;
export data=sd1.have r=have;
submit;
library(PolynomF);
sink("d:/txt/equ.txt");
(p <- poly_calc(have$X, have$Y));
sink();
endsubmit;
run;quit;
');

data _null_;

  infile "d:/txt/equ.txt";
  input;
  equFix = tranwrd(_infile_,"^","**");
  call symputx('equfix',equfix);

  rc=dosubl('
     data want;
        do x=0 to 2 by .1;
          if x=0 or mod(x,.5)=0 then do;
             y=&equfix;
             ano = cats("(",put(x,2.1),",",put( y,3.1),")");
          end;
          else do;
            y=&equfix;
            ano="";
          end;
          output;
        end;
     run;quit;
     ');
  stop;
run;quit;

options ls=64 ps=48;
proc plot data=want;
  plot y*x="." $ ano /box;
run;quit;

/*           _               _
  ___  _   _| |_ _ __  _   _| |_
 / _ \| | | | __| `_ \| | | | __|
| (_) | |_| | |_| |_) | |_| | |_
 \___/ \__,_|\__| .__/ \__,_|\__|
                |_|
*/

/**************************************************************************************************************************/
/*                                                                                                                        */
/*                                                                                                                        */
/*   d:/txt/equ.txt                                                                                                       */
/*                                                                                                                        */
/*   1 + 2.749529*x - 3.306066*x^2 + 3.034999*x^3 - 0.8850017*x^4 + 0.1248219*x^5                                         */
/*                                                                                                                        */
/*                                                                                                                        */
/*                                                                                                                        */
/*    ---+---------+---------+---------+---------+-----+                                                                  */
/*    |                                                |      WANT total obs=21                                           */
/*    |                 POLYNOMIAL                     |                                                                  */
/*    |                                                |     Obs     X        Y         ANO      POINT                    */
/*  8 +  1+2.749*x-3.30*x^2+3.03*x^3-0.88*x^4+0.12*x^5 |                                                                  */
/*    |                                                |       1    0.0    1.00000    (.0,1.0)    X                       */
/*    |                                                |       2    0.1    1.24484                                        */
/*    |    X        Y                 Point (2,7.4) X  |       3    0.2    1.44057                                        */
/*    |                                                |       4    0.3    1.60239                                        */
/*  7 +   0.0    1.00000                           /   +       5    0.4    1.74370                                        */
/*    |   0.5    1.64872                          /    |       6    0.5    1.87621    (.5,1.9)    X                       */
/*    |   1.0    2.71828                         .     |       7    0.6    2.01010                                        */
/*    |   1.5    4.48169                               |       8    0.7    2.15419                                        */
/*    |   2.0    7.38906                        /      |       9    0.8    2.31607                                        */
/*  6 +                                        .       +      10    0.9    2.50223                                        */
/*    |                                                |      11    1.0    2.71828    (1,2.7)     X                       */
/*    |                                       /        |      12    1.1    2.96902                                        */
/* Y  |                                      .         |      13    1.2    3.25864                                        */
/*    |                                                |      14    1.3    3.59083                                        */
/*  5 +                                    /           +      15    1.4    3.96899                                        */
/*    |                                   .            |      16    1.5    4.39631    (2,4.4)     X                       */
/*    |                                  /             |      17    1.6    4.87598                                        */
/*    |                          Point  X (2,4.4)      |      18    1.7    5.41129                                        */
/*    |                                /               |      19    1.8    6.00581                                        */
/*  4 +                              .                 +      20    1.9    6.66355                                        */
/*    |                             /                  |      21    2.0    7.38906    (2,7.4)     X                       */
/*    |                            .                   |                                                                  */
/*    |                           /                    |                                                                  */
/*    |                          /                     |                                                                  */
/*  3 +                 Point  X                       +                                                                  */
/*    |                      . (1,2.7)                 |                                                                  */
/*    |                    ./                          |                                                                  */
/*    |                  ./                            |                                                                  */
/*    |                .                               |                                                                  */
/*  2 +              ./                                +                                                                  */
/*    |      Point .X  (.5,1.9)                        |                                                                  */
/*    |          ./                                    |                                                                  */
/*    |        ./                                      |                                                                  */
/*    |       /                                        |                                                                  */
/*  1 +     X (.0,1.0)  Point                          +                                                                  */
/*    |                                                |                                                                  */
/*    ---+---------+---------+---------+---------+-----+                                                                  */
/*      0.0       0.5       1.0       1.5       2.0                                                                       */
/*                                                                                                                        */
/*                           X                                                                                            */
/*                                                                                                                        */
/**************************************************************************************************************************/

/*              _
  ___ _ __   __| |
 / _ \ `_ \ / _` |
|  __/ | | | (_| |
 \___|_| |_|\__,_|

*/
